<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analisar CSV com PapaParse</title>
    <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>

    <h1>Dados do CSV do Google Sheets</h1>
    <pre id="csvData"></pre>

    <script>
        const csvUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSgNA6a9P7_cwQO36W8fvAToRL0uClxIMuRIWIcOcGWlhb4croLQw_nzNqpqVxOK_pJ9pn8NIOqOTP_/pubhtml?gid=0&single=true';
        const outputDiv = document.getElementById('csvData');

        Papa.parse(csvUrl, {
            download: true, // Isso diz ao PapaParse para baixar o conteúdo da URL
            header: true,   // Assumindo que a primeira linha do seu CSV são os cabeçalhos
            complete: function(results) {
                console.log("Dados Analisados:", results.data);
                console.log("Erros (se houver):", results.errors);
                console.log("Meta (informações adicionais):", results.meta);

                if (results.data.length > 0) {
                    // Exemplo: Mostrar os primeiros 5 registros no <pre>
                    let displayContent = "Primeiros 5 registros:\n";
                    for (let i = 0; i < Math.min(results.data.length, 5); i++) {
                        displayContent += JSON.stringify(results.data[i], null, 2) + "\n";
                    }
                    outputDiv.textContent = displayContent;
                } else {
                    outputDiv.textContent = "Nenhum dado encontrado ou erro no CSV.";
                }
            },
            error: function(err, file) {
                console.error("Erro ao analisar CSV:", err, file);
                outputDiv.textContent = "Erro ao carregar ou analisar o CSV: " + err.message;
            }
        });
    </script>

</body>
</html>
